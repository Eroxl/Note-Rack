{"version":3,"sources":["../../src/components/Selectable.tsx"],"sourcesContent":["/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React, { useRef, useState } from 'react';\n\nimport SelectionManger from '../classes/SelectionManager';\n\ninterface SelectableProps {\n  accepts: string;\n  children: React.ReactNode[] | React.ReactNode;\n  selectionStyle?: React.CSSProperties;\n  selectionClassName?: string;\n}\n\nconst Selectable: React.FC<SelectableProps> = (props) => {\n  const {\n    children,\n    accepts,\n    selectionClassName,\n    selectionStyle,\n  } = props;\n\n  const [isSelecting, setIsSelecting] = useState(false);\n  const [selectionArea, setSelectionArea] = useState({\n    startY: 0,\n    endY: 0,\n    startX: 0,\n    endX: 0,\n  });\n\n  const selectableRef = useRef<HTMLDivElement>(null);\n\n  const selectionManager = SelectionManger.Instance;\n\n  return (\n    <div\n      ref={selectableRef}\n      onMouseMove={(e) => {\n        if (!isSelecting || !accepts) return;\n\n        const { clientX, clientY } = e;\n\n        setSelectionArea({\n          ...selectionArea,\n          endY: clientY,\n          endX: clientX,\n        });\n\n        selectionManager.highlightSelected(\n          {\n            top: Math.min(selectionArea.startY, clientY),\n            left: Math.min(selectionArea.startX, clientX),\n            bottom: Math.max(selectionArea.startY, clientY),\n            right: Math.max(selectionArea.startX, clientX),\n          },\n          accepts,\n        );\n      }}\n      onMouseDown={(e) => {\n        setIsSelecting(true);\n\n        const { clientX, clientY } = e;\n\n        setSelectionArea({\n          startY: clientY,\n          endY: clientY,\n          startX: clientX,\n          endX: clientX,\n        });\n\n        selectionManager.highlightSelected(\n          {\n            top: clientY,\n            left: clientX,\n            bottom: clientY,\n            right: clientX,\n          },\n          accepts,\n        );\n      }}\n      onMouseUp={() => {\n        setIsSelecting(false);\n\n        const selectedElements = selectionManager.getSelected({\n          top: Math.min(selectionArea.startY, selectionArea.endY),\n          left: Math.min(selectionArea.startX, selectionArea.endX),\n          bottom: Math.max(selectionArea.startY, selectionArea.endY),\n          right: Math.max(selectionArea.startX, selectionArea.endX),\n        }, accepts).filter(({ isSelected }) => isSelected).map((el) => el.selectableItem.item);\n\n        const selectedItemsData = selectedElements.map((el) => el());\n\n        selectionManager.selectableWatchers[accepts].forEach((watcher) => {\n          watcher(selectedItemsData);\n        });\n      }}\n      draggable={false}\n    >\n      {children}\n      {\n        isSelecting && (\n          <div\n            draggable={false}\n            className={selectionClassName}\n            style={{\n              position: 'absolute',\n              backgroundColor: '#fff',\n              opacity: 0.4,\n\n              ...selectionStyle,\n\n              top: Math.min(selectionArea.startY, selectionArea.endY),\n              left: Math.min(selectionArea.startX, selectionArea.endX),\n              width: Math.abs(selectionArea.startX - selectionArea.endX),\n              height: Math.abs(selectionArea.startY - selectionArea.endY),\n            }}\n          />\n        )\n      }\n    </div>\n  );\n};\n\nexport default Selectable;\n"],"names":["Selectable","props","children","accepts","selectionClassName","selectionStyle","isSelecting","setIsSelecting","useState","selectionArea","setSelectionArea","startY","endY","startX","endX","selectableRef","useRef","selectionManager","SelectionManger","Instance","div","ref","onMouseMove","e","clientX","clientY","highlightSelected","top","Math","min","left","bottom","max","right","onMouseDown","onMouseUp","selectedElements","getSelected","filter","isSelected","map","el","selectableItem","item","selectedItemsData","selectableWatchers","forEach","watcher","draggable","className","style","position","backgroundColor","opacity","width","abs","height"],"mappings":"AACA;;;;;;AAAwC,IAAA,MAAO,mCAAP,OAAO,EAAA;AAEnB,IAAA,iBAA6B,kCAA7B,6BAA6B,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASzD,MAAMA,UAAU,GAA8B,CAACC,KAAK,GAAK;IACvD,MAAM,EACJC,QAAQ,CAAA,EACRC,OAAO,CAAA,EACPC,kBAAkB,CAAA,EAClBC,cAAc,CAAA,IACf,GAAGJ,KAAK,AAAC;IAEV,MAAM,CAACK,WAAW,EAAEC,cAAc,CAAC,GAAGC,CAAAA,GAAAA,MAAQ,AAAO,CAAA,SAAP,CAAC,KAAK,CAAC,AAAC;IACtD,MAAM,CAACC,aAAa,EAAEC,gBAAgB,CAAC,GAAGF,CAAAA,GAAAA,MAAQ,AAKhD,CAAA,SALgD,CAAC;QACjDG,MAAM,EAAE,CAAC;QACTC,IAAI,EAAE,CAAC;QACPC,MAAM,EAAE,CAAC;QACTC,IAAI,EAAE,CAAC;KACR,CAAC,AAAC;IAEH,MAAMC,aAAa,GAAGC,CAAAA,GAAAA,MAAM,AAAsB,CAAA,OAAtB,CAAiB,IAAI,CAAC,AAAC;IAEnD,MAAMC,gBAAgB,GAAGC,iBAAe,QAAA,CAACC,QAAQ,AAAC;IAElD,qBACE,CAAA,cAoFM,CAAA,MApFLC,KAAG;QACFC,GAAG,EAAEN,aAAa;QAClBO,WAAW,EAAE,CAACC,CAAC,GAAK;YAClB,IAAI,CAACjB,WAAW,IAAI,CAACH,OAAO,EAAE,OAAO;YAErC,MAAM,EAAEqB,OAAO,CAAA,EAAEC,OAAO,CAAA,EAAE,GAAGF,CAAC,AAAC;YAE/Bb,gBAAgB,CAAC,kBACZD,aAAa;gBAChBG,IAAI,EAAEa,OAAO;gBACbX,IAAI,EAAEU,OAAO;cACd,CAAC,CAAC;YAEHP,gBAAgB,CAACS,iBAAiB,CAChC;gBACEC,GAAG,EAAEC,IAAI,CAACC,GAAG,CAACpB,aAAa,CAACE,MAAM,EAAEc,OAAO,CAAC;gBAC5CK,IAAI,EAAEF,IAAI,CAACC,GAAG,CAACpB,aAAa,CAACI,MAAM,EAAEW,OAAO,CAAC;gBAC7CO,MAAM,EAAEH,IAAI,CAACI,GAAG,CAACvB,aAAa,CAACE,MAAM,EAAEc,OAAO,CAAC;gBAC/CQ,KAAK,EAAEL,IAAI,CAACI,GAAG,CAACvB,aAAa,CAACI,MAAM,EAAEW,OAAO,CAAC;aAC/C,EACDrB,OAAO,CACR,CAAC;SACH;QACD+B,WAAW,EAAE,CAACX,CAAC,GAAK;YAClBhB,cAAc,CAAC,IAAI,CAAC,CAAC;YAErB,MAAM,EAAEiB,OAAO,CAAA,EAAEC,OAAO,CAAA,EAAE,GAAGF,CAAC,AAAC;YAE/Bb,gBAAgB,CAAC;gBACfC,MAAM,EAAEc,OAAO;gBACfb,IAAI,EAAEa,OAAO;gBACbZ,MAAM,EAAEW,OAAO;gBACfV,IAAI,EAAEU,OAAO;aACd,CAAC,CAAC;YAEHP,gBAAgB,CAACS,iBAAiB,CAChC;gBACEC,GAAG,EAAEF,OAAO;gBACZK,IAAI,EAAEN,OAAO;gBACbO,MAAM,EAAEN,OAAO;gBACfQ,KAAK,EAAET,OAAO;aACf,EACDrB,OAAO,CACR,CAAC;SACH;QACDgC,SAAS,EAAE,IAAM;YACf5B,cAAc,CAAC,KAAK,CAAC,CAAC;YAEtB,MAAM6B,gBAAgB,GAAGnB,gBAAgB,CAACoB,WAAW,CAAC;gBACpDV,GAAG,EAAEC,IAAI,CAACC,GAAG,CAACpB,aAAa,CAACE,MAAM,EAAEF,aAAa,CAACG,IAAI,CAAC;gBACvDkB,IAAI,EAAEF,IAAI,CAACC,GAAG,CAACpB,aAAa,CAACI,MAAM,EAAEJ,aAAa,CAACK,IAAI,CAAC;gBACxDiB,MAAM,EAAEH,IAAI,CAACI,GAAG,CAACvB,aAAa,CAACE,MAAM,EAAEF,aAAa,CAACG,IAAI,CAAC;gBAC1DqB,KAAK,EAAEL,IAAI,CAACI,GAAG,CAACvB,aAAa,CAACI,MAAM,EAAEJ,aAAa,CAACK,IAAI,CAAC;aAC1D,EAAEX,OAAO,CAAC,CAACmC,MAAM,CAAC,CAAC,EAAEC,UAAU,CAAA,EAAE,GAAKA,UAAU;YAAA,CAAC,CAACC,GAAG,CAAC,CAACC,EAAE,GAAKA,EAAE,CAACC,cAAc,CAACC,IAAI;YAAA,CAAC,AAAC;YAEvF,MAAMC,iBAAiB,GAAGR,gBAAgB,CAACI,GAAG,CAAC,CAACC,EAAE,GAAKA,EAAE,EAAE;YAAA,CAAC,AAAC;YAE7DxB,gBAAgB,CAAC4B,kBAAkB,CAAC1C,OAAO,CAAC,CAAC2C,OAAO,CAAC,CAACC,OAAO,GAAK;gBAChEA,OAAO,CAACH,iBAAiB,CAAC,CAAC;aAC5B,CAAC,CAAC;SACJ;QACDI,SAAS,EAAE,KAAK;;YAEf9C,QAAQ;YAEPI,WAAW,kBACT,CAAA,cAeE,CAAA,KAfDc,KAAG;gBACF4B,SAAS,EAAE,KAAK;gBAChBC,SAAS,EAAE7C,kBAAkB;gBAC7B8C,KAAK,EAAE;oBACLC,QAAQ,EAAE,UAAU;oBACpBC,eAAe,EAAE,MAAM;oBACvBC,OAAO,EAAE,GAAG;mBAEThD,cAAc;oBAEjBsB,GAAG,EAAEC,IAAI,CAACC,GAAG,CAACpB,aAAa,CAACE,MAAM,EAAEF,aAAa,CAACG,IAAI,CAAC;oBACvDkB,IAAI,EAAEF,IAAI,CAACC,GAAG,CAACpB,aAAa,CAACI,MAAM,EAAEJ,aAAa,CAACK,IAAI,CAAC;oBACxDwC,KAAK,EAAE1B,IAAI,CAAC2B,GAAG,CAAC9C,aAAa,CAACI,MAAM,GAAGJ,aAAa,CAACK,IAAI,CAAC;oBAC1D0C,MAAM,EAAE5B,IAAI,CAAC2B,GAAG,CAAC9C,aAAa,CAACE,MAAM,GAAGF,aAAa,CAACG,IAAI,CAAC;kBAC5D;cACD,AACH;;MAEC,CACN;CACH,AAAC;eAEaZ,UAAU"}